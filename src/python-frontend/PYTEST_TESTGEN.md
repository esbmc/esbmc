# Python Pytest Test Case Generation

## Overview

ESBMC now supports automatic generation of pytest test cases for Python programs. This feature automatically discover test inputs that achieve high code coverage.

## Usage

### Basic Command

```bash
esbmc example.py --branch-coverage --generate-pytest-testcase
```

This will generate a `test_example.py` file containing pytest test cases.

### Input Format

Your Python code should use `__VERIFIER_nondet_*()` functions to mark symbolic inputs:

```python
# example.py
def check_positive(n: int) -> int:
    """Check if a number is positive and return its double"""
    assert n > 0, "Number must be positive"
    return n * 2

# Test generation mode: use nondet inputs
check_sign(__VERIFIER_nondet_int())
```

### Output Format

ESBMC will generate a pytest file like this:

```python
# Auto-generated by ESBMC 7.11.0
# Original file: example.py

from test import *
import pytest

@pytest.mark.parametrize("n", [
    -9223372036854775805,
    2047,
])
def test_check_sign(n):
    """Auto-generated test cases for check_sign"""
    check_sign(n)

```

### Running the Tests

```bash
# Run the generated tests
pytest test_case.py

# Run with coverage
pytest test_case.py --cov=example
```

## Supported Types

- `__VERIFIER_nondet_int()` → Python int
- `__VERIFIER_nondet_bool()` → Python True/False
- `__VERIFIER_nondet_float()` → Python float

## Example: Multiple Parameters

```python
# example.py
def add_positive(a: int, b: int) -> int:
    """Add two positive numbers"""
    if a < 0 or b < 0:
        a = a + b
    return a + b

add_positive(__VERIFIER_nondet_int(), __VERIFIER_nondet_int())
```

Generated output:

```python
# Auto-generated by ESBMC 7.11.0
# Original file: example.py

from test import *
import pytest

@pytest.mark.parametrize("a,b", [
    (-9223372036854775808, -9223372036854775808),
    (0, 0),
    (-9223372036854775808, -9223372036854775808),
])
def test_add_positive(a,b):
    """Auto-generated test cases for add_positive"""
    add_positive(a, b)


```

## Comparison with C Test Generation

This feature is similar to the existing `--generate-testcase` flag for C programs, but outputs pytest-compatible Python test files instead of XML.

| Feature | C (`--generate-testcase`) | Python (`--generate-pytest-testcase`) |
|---------|---------------------------|---------------------------------------|
| Input Format | `int a = __VERIFIER_nondet_int();` | `__VERIFIER_nondet_int()` |
| Output Format | XML (Test-Comp format) | Python (pytest format) |
| Test Execution | Test-Comp tools | pytest |
| Coverage Measurement | Test-Comp | pytest-cov |


